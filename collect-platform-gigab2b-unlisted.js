var collectPlatformGigab2bUnlisted=function(){"use strict";var oe=Object.defineProperty;var ie=(m,g,h)=>g in m?oe(m,g,{enumerable:!0,configurable:!0,writable:!0,value:h}):m[g]=h;var H=(m,g,h)=>ie(m,typeof g!="symbol"?g+"":g,h);function m(e){return e==null||typeof e=="function"?{main:e}:e}const g=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),h=new Map(g);class P extends Error{constructor(r){super(P._prepareSuperMessage(r));H(this,"name","NonError")}static _prepareSuperMessage(r){try{return JSON.stringify(r)}catch{return String(r)}}}const k=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],O=new WeakSet,B=e=>{O.add(e);const t=e.toJSON();return O.delete(e),t},S=e=>h.get(e)??Error,M=({from:e,seen:t,to:r,forceEnumerable:a,maxDepth:p,depth:d,useToJSON:s,serialize:u})=>{if(!r)if(Array.isArray(e))r=[];else if(!u&&L(e)){const n=S(e.name);r=new n}else r={};if(t.push(e),d>=p)return r;if(s&&typeof e.toJSON=="function"&&!O.has(e))return B(e);const o=n=>M({from:n,seen:[...t],forceEnumerable:a,maxDepth:p,depth:d,useToJSON:s,serialize:u});for(const[n,i]of Object.entries(e)){if(i&&i instanceof Uint8Array&&i.constructor.name==="Buffer"){r[n]="[object Buffer]";continue}if(i!==null&&typeof i=="object"&&typeof i.pipe=="function"){r[n]="[object Stream]";continue}if(typeof i!="function"){if(!i||typeof i!="object"){try{r[n]=i}catch{}continue}if(!t.includes(e[n])){d++,r[n]=o(e[n]);continue}r[n]="[Circular]"}}for(const{property:n,enumerable:i}of k)typeof e[n]<"u"&&e[n]!==null&&Object.defineProperty(r,n,{value:L(e[n])?o(e[n]):e[n],enumerable:a?!0:i,configurable:!0,writable:!0});return r};function z(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:a=!0}=t;return typeof e=="object"&&e!==null?M({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:a,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function F(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(V(e)){const a=S(e.name);return M({from:e,seen:[],to:new a,maxDepth:r,depth:0,serialize:!1})}return new P(e)}function L(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function V(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var W=Object.defineProperty,X=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,j=(e,t,r)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t)=>{for(var r in t||(t={}))q.call(t,r)&&j(e,r,t[r]);if(N)for(var r of N(t))G.call(t,r)&&j(e,r,t[r]);return e},T=(e,t)=>X(e,Y(t)),U=(e,t,r)=>new Promise((a,p)=>{var d=o=>{try{u(r.next(o))}catch(n){p(n)}},s=o=>{try{u(r.throw(o))}catch(n){p(n)}},u=o=>o.done?a(o.value):Promise.resolve(o.value).then(d,s);u((r=r.apply(e,t)).next())});function Q(e){let t,r={};function a(){Object.entries(r).length===0&&(t==null||t(),t=void 0)}let p=Math.floor(Math.random()*1e4);function d(){return p++}return{sendMessage(s,u,...o){return U(this,null,function*(){var n,i,c,w;const x={id:d(),type:s,data:u,timestamp:Date.now()},b=(i=yield(n=e.verifyMessageData)==null?void 0:n.call(e,x))!=null?i:x;(c=e.logger)==null||c.debug(`[messaging] sendMessage {id=${b.id}} ─ᐅ`,b,...o);const v=yield e.sendMessage(b,...o),{res:l,err:f}=v??{err:new Error("No response")};if((w=e.logger)==null||w.debug(`[messaging] sendMessage {id=${b.id}} ᐊ─`,{res:l,err:f}),f!=null)throw F(f);return l})},onMessage(s,u){var o,n,i;if(t==null&&((o=e.logger)==null||o.debug(`[messaging] "${s}" initialized the message listener for this context`),t=e.addRootListener(c=>{var w,x;if(typeof c.type!="string"||typeof c.timestamp!="number"){if(e.breakError)return;const l=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(c)}`);throw(w=e.logger)==null||w.error(l),l}(x=e==null?void 0:e.logger)==null||x.debug("[messaging] Received message",c);const b=r[c.type];if(b==null)return;const v=b(c);return Promise.resolve(v).then(l=>{var f,C;return(C=(f=e.verifyMessageData)==null?void 0:f.call(e,l))!=null?C:l}).then(l=>{var f;return(f=e==null?void 0:e.logger)==null||f.debug(`[messaging] onMessage {id=${c.id}} ─ᐅ`,{res:l}),{res:l}}).catch(l=>{var f;return(f=e==null?void 0:e.logger)==null||f.debug(`[messaging] onMessage {id=${c.id}} ─ᐅ`,{err:l}),{err:z(l)}})})),r[s]!=null){const c=Error(`[messaging] In this JS context, only one listener can be setup for ${s}`);throw(n=e.logger)==null||n.error(c),c}return r[s]=u,(i=e.logger)==null||i.log(`[messaging] Added listener for ${s}`),()=>{delete r[s],a()}},removeAllListeners(){Object.keys(r).forEach(s=>{delete r[s]}),a()}}}for(var y=256,A=[],D=256,E;y--;)A[y]=(y+256).toString(16).substring(1);function Z(e){var t=0,r=11;if(!E||y+r>D*2)for(E="",y=0;t<D;t++)E+=A[Math.random()*256|0];return E.substring(y,y+++r)}var J="@webext-core/messaging/window",$="@webext-core/messaging/window/response";function K(e){const t=e.namespace,r=Z();let a=[];const p=(s,u)=>new Promise(o=>{const n=c=>{c.data.type===$&&c.data.namespace===t&&c.data.instanceId!==r&&c.data.message.type===s.type&&(o(c.data.response),i())},i=()=>window.removeEventListener("message",n);a.push(i),window.addEventListener("message",n),window.postMessage({type:J,message:s,senderOrigin:location.origin,namespace:t,instanceId:r},u??"*")}),d=Q(T(R({},e),{sendMessage(s,u){return p(s,u)},addRootListener(s){const u=o=>U(this,null,function*(){if(o.data.type!==J||o.data.namespace!==t||o.data.instanceId===r)return;const n=yield s(o.data.message);window.postMessage({type:$,response:n,instanceId:r,message:o.data.message,namespace:t},o.data.senderOrigin)});return window.addEventListener("message",u),()=>window.removeEventListener("message",u)},verifyMessageData(s){return structuredClone(s)}}));return T(R({},d),{removeAllListeners(){d.removeAllListeners(),a.forEach(s=>s()),a=[]}})}const ee=e=>{const{searchParams:t}=new URL(e),r=t.get("route"),a=t.get("product_id");if(r==="/product/info/info/baseInfos")return{product_id:a}},re=e=>{const{searchParams:t}=new URL(e),r=t.get("route"),a=t.get("product_id");if(r==="/product/info/price/list")return{product_id:a}},te=e=>{const{searchParams:t}=new URL(e);return t.get("route")==="/common/header/getHeaderInfo"},I=K({namespace:"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}),ne=m({main(){const e=Object.getOwnPropertyDescriptor(XMLHttpRequest.prototype,"responseText");Object.defineProperty(XMLHttpRequest.prototype,"responseText",{get(){const t=e.get.call(this);try{const r=this.responseURL;te(r)&&I.sendMessage("header",{response:JSON.parse(t).data});const p=re(r);p&&I.sendMessage("priceInfo",{...p,response:JSON.parse(t).data});const d=ee(r);d&&I.sendMessage("productInfo",{...d,response:JSON.parse(t).data})}catch{}return t}})}});function ae(){}function _(e,...t){}const se={debug:(...e)=>_(console.debug,...e),log:(...e)=>_(console.log,...e),warn:(...e)=>_(console.warn,...e),error:(...e)=>_(console.error,...e)};return(async()=>{try{return await ne.main()}catch(e){throw se.error('The unlisted script "collect-platform-gigab2b-unlisted" crashed on startup!',e),e}})()}();
collectPlatformGigab2bUnlisted;
